<div class="min-h-screen font-sans bg-gray-50/50">
  <main class="container mx-auto max-w-5xl ">
    <div class="rounded-2xl bg-white/80 ring-1 ring-gray-200 shadow-sm relative overflow-hidden">
      <div class="h-1 overflow-hidden rounded-t-2xl">
        <div class="h-full loader-bar" *ngIf="loading"></div>
      </div>

      <div class="p-3 md:p-6">
        <div class="flex flex-wrap items-center justify-between gap-3 mb-3">
          <div class="flex flex-wrap items-center gap-2 md:gap-3">
            <h2 class="text-base md:text-lg font-semibold text-gray-900" i18n="@@quickEmail.title">Your Quick Email Address</h2>
            <div class="inline-flex items-center gap-1 rounded-lg bg-white px-2 py-1 ring-1 ring-gray-200 text-xs md:text-sm font-medium">
              <lucide-icon name="clock" [size]="14" class="text-red-500 md:hidden"></lucide-icon>
              <lucide-icon name="clock" [size]="16" class="text-red-500 hidden md:block"></lucide-icon>
              <span class="text-red-600">
                @if (emailExpired) {
                  <span i18n="@@quickEmail.timerExpired">Expired</span>
                } @else {
                  {{ formatTimeRemaining() }}
                }
              </span>
            </div>
            <button
              type="button"
              (click)="resetTimer()"
              class=" hidden md:inline-flex items-center gap-1 rounded-lg px-2.5 py-1 text-xs md:text-sm font-medium text-gray-600 hover:bg-gray-100 ring-1 ring-inset ring-gray-300 transition disabled:opacity-60 disabled:cursor-not-allowed"
              [disabled]="emailExpired">
              <lucide-icon name="refresh-cw" [size]="14"></lucide-icon>
              <span i18n="@@quickEmail.resetTimer">Reset</span>
            </button>
          </div>

          <button
            type="button"
            (click)="generateNewQuickEmail()"
            class="hidden md:inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-gray-900 text-white hover:bg-gray-800 transition">
            <lucide-icon name="refresh-cw" [size]="16"></lucide-icon>
            <span i18n="@@quickEmail.newEmail">New Email</span>
          </button>
        </div>

        <div class="rounded-xl ring-1 ring-dashed ring-gray-300 bg-gray-50 px-3.5 md:px-4 py-2.5">
          <div class="flex flex-wrap items-center gap-2 md:gap-3 justify-between">
            <div class="flex items-center gap-2 min-w-0 flex-1">
  

              <div
                class="inline-flex items-center gap-2 min-w-0 cursor-pointer overflow-hidden"
                [class.cursor-not-allowed]="emailExpired"
                (click)="emailExpired ? null : copyEmail()">
                <span
                  class="inline-flex items-center gap-2 rounded-lg bg-white px-2.5 py-1 ring-1 ring-gray-200"
                  [class.opacity-60]="emailExpired">
                  <lucide-icon name="inbox" [size]="12" class="text-gray-500 md:hidden"></lucide-icon>
                  <lucide-icon name="inbox" [size]="18" class="text-gray-500 hidden md:block"></lucide-icon>
                  <span class="font-mono text-gray-900 truncate text-xs md:text-base overflow-hidden">
                    @if (emailGenerating) {
                      <span i18n="@@quickEmail.generating">Generating new email...</span>
                    } @else if (emailExpired) {
                      <span i18n="@@quickEmail.emailExpiredMessage">Generate a new email to continue</span>
                    } @else {
                      {{ currentEmail }}
                    }
                  </span>
                </span>
              </div>
            </div>

            <div class="hidden md:flex items-center gap-2">
              <button
                type="button"
                (click)="resetTimer()"
                class="inline-flex items-center justify-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-100 transition disabled:opacity-60 disabled:cursor-not-allowed"
                [disabled]="emailExpired">
                <lucide-icon name="clock-4" [size]="14"></lucide-icon>
                <span i18n="@@quickEmail.resetTimer">Reset</span>
              </button>

              <button
                type="button"
                (click)="copyEmail()"
                class="inline-flex items-center justify-center gap-2 rounded-lg px-3 py-2 text-sm font-medium ring-1 ring-inset transition disabled:opacity-60 disabled:cursor-not-allowed"
                [ngClass]="copied ? 'bg-green-50 text-green-700 ring-green-200' : 'text-gray-700 ring-gray-300 hover:bg-gray-100'"
                [disabled]="emailExpired || emailGenerating || !currentEmail">
                <lucide-icon [name]="copied ? 'check' : 'copy'" [size]="14"></lucide-icon>
                <span>
                  @if (copied) { <span i18n="@@quickEmail.copiedMessage">Copied</span> }
                  @else { <span i18n="@@quickEmail.copyMessage1">Copy</span> }
                </span>
              </button>
            </div>
          </div>
        </div>

        <div class="mt-3 grid grid-cols-3 gap-2 md:hidden">
          <button
            type="button"
            (click)="resetTimer()"
            class="inline-flex items-center justify-center gap-1.5 rounded-lg px-2 py-2 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-100 transition disabled:opacity-60 disabled:cursor-not-allowed"
            [disabled]="emailExpired">
            <lucide-icon name="clock-4" [size]="12"></lucide-icon>
            <span i18n="@@quickEmail.resetTimer">Reset</span>
          </button>

          <button
            type="button"
            (click)="generateNewQuickEmail()"
            class="inline-flex items-center justify-center gap-1.5 rounded-lg px-2 py-2 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-100 transition">
            <lucide-icon name="refresh-cw" [size]="12"></lucide-icon>
            <span i18n="@@quickEmail.newEmail">New Email</span>
          </button>

          <button
            type="button"
            (click)="copyEmail()"
            class="inline-flex items-center justify-center gap-1.5 rounded-lg px-2 py-2 text-xs font-medium ring-1 ring-inset transition disabled:opacity-60 disabled:cursor-not-allowed"
            [ngClass]="copied ? 'bg-green-50 text-green-700 ring-green-200' : 'text-gray-700 ring-gray-300 hover:bg-gray-100'"
            [disabled]="emailExpired || emailGenerating || !currentEmail">
            <lucide-icon [name]="copied ? 'check' : 'copy'" [size]="12"></lucide-icon>
            <span i18n="@@quickEmail.copyButtonMobile">{{ copied ? 'Copied!' : 'Copy' }}</span>
          </button>
        </div>
      </div>

      <div class="px-3 md:px-6 pb-5">
        <div class="rounded-2xl ring-1 ring-gray-200 bg-white">
          <div class="flex items-center justify-between gap-1 md:gap-3 px-4 pt-4 flex-wrap">
            <h2 class="text-base font-semibold text-gray-900" i18n="@@quickEmail.inbox">Your Inbox</h2>
            <div class="flex items-center text-sm text-gray-600">
              <span class="mr-2" i18n="@@quickEmail.autoRefresh">Auto-refresh in {{ countdown() }}s</span>
              <button
                type="button"
                (click)="reload()"
                class="p-1.5 rounded-lg hover:bg-gray-100 text-gray-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500"
                [disabled]="emailExpired">
                <lucide-icon name="refresh-cw" [size]="16" [class.animate-spin]="refreshing"></lucide-icon>
                <span class="sr-only">Reload</span>
              </button>
            </div>
          </div>

          <div class="p-4 pt-3">
            <div class="h-96 max-h-[28rem] overflow-y-auto custom-scroll">
              <div *ngIf="emailExpired" class="h-full grid place-items-center">
                <div class="text-center max-w-sm mx-auto">
                  <lucide-icon name="mail-x" [size]="36" class="text-gray-400 mx-auto mb-3"></lucide-icon>
                  <p class="text-sm text-gray-600" i18n="@@quickEmail.expiredInbox">Email expired. Generate a new email to view inbox.</p>
                  <button
                    type="button"
                    (click)="generateNewQuickEmail()"
                    class="mt-3 inline-flex items-center gap-2 rounded-lg bg-gray-900 px-3.5 py-2 text-sm text-white hover:bg-gray-800 transition">
                    <lucide-icon name="refresh-cw" [size]="14"></lucide-icon>
                    <span i18n="@@quickEmail.generateNewEmail">Generate New Email</span>
                  </button>
                </div>
              </div>

              <div *ngIf="!emailExpired && emails.length === 0" class="h-full grid place-items-center">
                <div class="text-center">
                  <div class="mx-auto mb-4 grid place-items-center">
                    <div class="relative w-14 h-14">
                      <div class="absolute inset-0 grid place-items-center">
                        <lucide-icon name="mail" [size]="22" class="text-gray-400 animate-bounce" style="animation-duration:2s;"></lucide-icon>
                      </div>
                    </div>
                  </div>
                  <p class="text-sm text-gray-600" i18n="@@quickEmail.waitingForMessages">
                    Waiting for messages for <span class="font-medium">{{ currentEmail }}</span>
                  </p>
                  <button
                    type="button"
                    (click)="reload()"
                    class="mt-3 inline-flex items-center gap-2 rounded-lg bg-gray-100 px-3.5 py-2 text-sm text-gray-900 hover:bg-gray-200 ring-1 ring-inset ring-gray-200 transition">
                    <lucide-icon name="refresh-cw" [size]="14" [class.animate-spin]="refreshing"></lucide-icon>
                    <span i18n="@@mainTempMail.checkAgain">Check Again</span>
                  </button>
                </div>
              </div>

              <div *ngIf="!emailExpired && emails.length > 0" class="space-y-2">
                <button
                  *ngFor="let email of emails"
                  type="button"
                  (click)="viewEmail(email)"
                  class="w-full text-left p-3.5 rounded-xl ring-1 ring-gray-200 hover:bg-gray-50 transition flex items-start gap-3"
                  [class.bg-gray-50]="!email.read"
                  [attr.aria-label]="email.subject || 'No subject'">
                  <div class="shrink-0">
                    <div class="w-10 h-10 rounded-full grid place-items-center"
                         [ngClass]="!email.read ? 'bg-blue-100' : 'bg-gray-100'">
                      <lucide-icon [name]="!email.read ? 'mail' : 'mail-open'" [size]="18"
                                   [ngClass]="!email.read ? 'text-blue-700' : 'text-gray-600'"></lucide-icon>
                    </div>
                  </div>

                  <div class="min-w-0 flex-1">
                    <div class="flex items-start justify-between gap-3">
                      <h3 class="font-medium text-gray-900 truncate">
                        {{ email.subject || '(No subject)' }}
                      </h3>
                      <span class="text-xs text-gray-500 shrink-0 whitespace-nowrap">
                        {{ email.created_at | date:'shortTime' }}
                      </span>
                    </div>
                    <p class="text-sm text-gray-600 truncate">{{ email.from_email }}</p>
                    <p *ngIf="email.preview" class="text-xs text-gray-500 mt-1 line-clamp-2">
                      {{ email.preview }}
                    </p>
                  </div>
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <section class="rounded-2xl ring-1 ring-gray-200 bg-white p-4 md:p-6 mt-6">
      <h2 class="text-base font-semibold text-gray-900 mb-3" i18n="@@quickEmail.featuresTitle">Quick Email Features</h2>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
        <div class="rounded-xl ring-1 ring-gray-200 bg-gray-50 p-3 text-sm">
          <div class="flex items-center gap-2">
            <lucide-icon name="clock" [size]="16" class="text-red-500"></lucide-icon>
            <h3 class="font-medium" i18n="@@quickEmail.feature1Title">{{pageTimeCount}}-Minute Expiry</h3>
          </div>
          <p class="text-xs text-gray-600 mt-1" i18n="@@quickEmail.feature1Desc">Perfect for quick verifications</p>
        </div>

        <div class="rounded-xl ring-1 ring-gray-200 bg-gray-50 p-3 text-sm">
          <div class="flex items-center gap-2">
            <lucide-icon name="zap" [size]="16" class="text-yellow-500"></lucide-icon>
            <h3 class="font-medium" i18n="@@quickEmail.feature2Title">Instant Generation</h3>
          </div>
          <p class="text-xs text-gray-600 mt-1" i18n="@@quickEmail.feature2Desc">Get a new email instantly</p>
        </div>

        <div class="rounded-xl ring-1 ring-gray-200 bg-gray-50 p-3 text-sm">
          <div class="flex items-center gap-2">
            <lucide-icon name="shield" [size]="16" class="text-green-500"></lucide-icon>
            <h3 class="font-medium" i18n="@@quickEmail.feature3Title">Privacy Focused</h3>
          </div>
          <p class="text-xs text-gray-600 mt-1" i18n="@@quickEmail.feature3Desc">Completely anonymous</p>
        </div>
      </div>
    </section>
  </main>
</div>
